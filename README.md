# 1. Тема и целевая аудитория

Google Drive - облачное B2C и B2B хранилище файлов

### Минимальный функционал

- Авторизация, регистрация;
- Загрузка файлов;
- Список последних файлов (стартовая страница);
- Просмотр существующих файлов, их скачивание;
- Предварительный просмотр медиаконтента;
- Управление доступом;
- Поиск;
- Система ограничения доступного места.

### Ключевые продуктовые решения

- Сжатие медиаконтента при предварительном просмотре из браузера;
- Для поиска индексируются тексты документов, субтитры видео, сканы изображений;
- Возможность просматривать, создавать и изменять архивы удалённо, без их скачивания
  (например, если надо в большой архив добавить один файл, пользователь присылает
  на сервер этот файл, а система автоматически дополнит архив);
- Возможность поделиться файлами по ссылке;
- Возможность просмотра папки с фотографиями в виде плиток с thumbnails;
- Возможность задавать разрешение видео при предварительном просмотре.

## Целевая аудитория

Данные взяты с HypeStat. [^1]

| K                              | V    |
| ------------------------------ | ---- |
| MAU                            | 2.0B |
| DAU                            | 100M |
| Зарегистрировано пользователей | 2.8B |

```mermaid
pie title Страна
    "США" : 1991
    "Индия" : 784
    "Бразилия" : 671
    "Япония" : 629
    "Индонезия" : 424
    "Другие" : 5501
```

Другой информации о географии ЦА я не нашёл.
Имеющиеся данные были экстраполированы. [Ссылка на расчёт](calculations/regions.md)

```mermaid
pie title Регион (экстраполяция)
    "Африка" : 28
    "Австралия и Океания" : 45
    "Япония и Ю. Корея" : 180
    "Азия" : 370
    "Латинская Америка" : 400
    "Северная Америка" : 430
    "Европа" : 800
```

```mermaid
pie title UserAgent
    "Десктоп" : 1991
    "Мобильный Web" : 384
    "Приложение" : 471
```

```mermaid
pie title Пол
    "М" : 53
    "Ж" : 47
```

# 2. Расчёт нагрузки

### Исходные данные

<details>
<summary>Данные и гипотезы об использовании диска</summary>

Месячная аудитория - 2.0 B; Дневная аудитория - 100 M

В 2022 году на Google Drive было загружено 250 млрд файлов, или 3.4 эксабайт. [^2]

64% опрошенных пользователей хранят на диске фотографии, 50% - документы, 44% - архивы, 35% - видео. [^3]

В среднем пользователь использует 3.9 гигабайт для хранения файлов. [^4]

Проанализировав графики трафика от Google[^5], можно вычислить, что пиковый трафик составляет
примерно 160% от среднесуточного.

Предположим, что в среднем пользователь скачивает все свои файлы раз в месяц.

Предположим, что 30% входящего контента - это видео, 20% - фотографии,
20% - архивы.

Предположим, что пользователь каждый день смотрит 50 фотографий,

</details>

<details>
<summary>Данные и гипотезы о размере медиаконтента</summary>

Растровое изображение, снятое на камеру смартфона в формате JPEG, весит в среднем
4 Мб. При предпросмотре такого изображения через Web-интерфейс облака загружается
в среднем 1.2 Мб.

Видео, снятое на камеру смартфона, имеет битрейт порядка 24 Мбит/с.

Битрейт потоковой передачи видео: 2,5 Мбит/с - видео YouTube с разрешением
720p (с кодированием H.264)[^6]. Google Drive использует те же технологии для передачи
видео, что и YouTube.

Средний размер пакета с сегментом видео - 1.5 Мб. Заголовки запроса и ответа занимают 3 Кб
на каждый сегмент.

</details>

### Продуктовые метрики (в пересчёте на пользователя)

| Тип запроса      | Requests /User /Day    | Data /User /Day     |
| ---------------- | ---------------------- | ------------------- |
| Добавление файла | $3.4\cdot10^{-1}$ Reqs | $4.7\cdot10^{0}$ Мб |
| Скачивание файла | $1.0 \cdot 10^1$ Reqs  | $1.2\cdot10^2$ Мб   |

| Тип запроса            | Requests /User /Day           | Data /User /Day                  |
| ---------------------- | ----------------------------- | -------------------------------- |
| Просмотр медиаконтента | 50 фотографий, 10 минут видео | $1.5\cdot10^2$ Мб (после сжатия) |

| Тип запроса             | Requests /User /Day |
| ----------------------- | ------------------- |
| Поиск                   | $1.0\cdot10^1$ Reqs |
| Список последних файлов | $1.0\cdot10^1$ Reqs |
| Управление доступом     | $1.0\cdot10^0$ Reqs |

### Продуктовые метрики (в глобальном пересчёте)

|Тип запроса|Трафик (avg)|RPS (avg)|PPS (avg)|Трафик (max)|RPS (max)|PPS (max)|
|-|-|-|-|-|-|-|
|1|2|3|4|5|6|7|


# Список источников

[^1]: https://hypestat.com/info/drive.google.com (дата обращения: 23.02.2025)
[^2]: https://web.archive.org/web/20240626222045/https://techreport.com/statistics/software-web/gmail-statistics/ (дата обращения: 23.02.2025)
[^3]: https://www.statista.com/forecasts/1011667/file-types-google-one-google-drive-in-the-us (дата обращения: 23.02.2025)
[^4]: Результаты опроса, проведённого автором среди 8 человек: https://docs.google.com/spreadsheets/d/1Ivwkm36-tmMWPxk_14mbQxpYs6oTPlgk/edit (дата обращения: 23.02.2025)
[^5]: https://transparencyreport.google.com/traffic/overview?fraction_traffic=start:1740009600000;end:1740527999999;product:4;region:US&lu=fraction_traffic&hl=ru - данные о трафике от Google (дата обращения: 02.03.2025)
[^6]: https://ru.wikipedia.org/wiki/Битрейт
